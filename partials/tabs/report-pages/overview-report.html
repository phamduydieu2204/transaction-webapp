<!-- Overview Report - Tổng quan kinh doanh -->
<div class="report-header">
    <h2 class="report-title">
      <i class="fas fa-chart-line"></i> 
      Tổng quan kinh doanh
    </h2>
    <div class="report-subtitle">
      <span id="overview-period-display">Tháng này</span>
      <span class="refresh-status" id="overview-refresh-status">
        <i class="fas fa-sync-alt"></i> Đã cập nhật
      </span>
    </div>
  </div>

  <!-- KPI Cards -->
  <div class="kpi-grid">
    <!-- Tổng doanh thu (Đã hoàn tất) -->
    <div class="kpi-card revenue-card">
      <div class="kpi-icon">
        <i class="fas fa-check-circle"></i>
      </div>
      <div class="kpi-content">
        <div class="kpi-label">Doanh thu thực</div>
        <div class="kpi-value" id="completed-revenue">0 ₫</div>
        <div class="kpi-change" id="completed-change">
          <i class="fas fa-arrow-up"></i> +0%
        </div>
        <div class="kpi-sub-label">Đã hoàn tất</div>
      </div>
    </div>

    <!-- Đang chờ thu (Đã thanh toán) -->
    <div class="kpi-card paid-card">
      <div class="kpi-icon">
        <i class="fas fa-clock"></i>
      </div>
      <div class="kpi-content">
        <div class="kpi-label">Đang chờ giao</div>
        <div class="kpi-value" id="paid-revenue">0 ₫</div>
        <div class="kpi-change" id="paid-change">
          <i class="fas fa-arrow-up"></i> +0%
        </div>
        <div class="kpi-sub-label">Đã thanh toán</div>
      </div>
    </div>

    <!-- Hoàn tiền -->
    <div class="kpi-card refund-card">
      <div class="kpi-icon">
        <i class="fas fa-undo-alt"></i>
      </div>
      <div class="kpi-content">
        <div class="kpi-label">Hoàn tiền</div>
        <div class="kpi-value" id="refund-revenue">0 ₫</div>
        <div class="kpi-change" id="refund-change">
          <i class="fas fa-arrow-up"></i> +0%
        </div>
        <div class="kpi-sub-label">Hoàn tiền khách hàng</div>
      </div>
    </div>

    <!-- Tổng giao dịch -->
    <div class="kpi-card transaction-card">
      <div class="kpi-icon">
        <i class="fas fa-handshake"></i>
      </div>
      <div class="kpi-content">
        <div class="kpi-label">Tổng giao dịch</div>
        <div class="kpi-value" id="total-transactions">0</div>
        <div class="kpi-change" id="transaction-change">
          <i class="fas fa-arrow-up"></i> +0%
        </div>
        <div class="kpi-sub-label">Tất cả trạng thái</div>
      </div>
    </div>
  </div>

  <!-- Transaction Status Summary -->
  <div class="status-summary-grid">
    <div class="status-card">
      <h4>Phân bố trạng thái giao dịch</h4>
      <div class="status-breakdown">
        <div class="status-item completed">
          <div class="status-info">
            <span class="status-label">Đã hoàn tất</span>
            <span class="status-count" id="completed-count">0</span>
          </div>
          <div class="status-bar">
            <div class="status-fill" id="completed-bar" style="width: 0%"></div>
          </div>
          <div class="status-percentage" id="completed-percentage">0%</div>
        </div>
        
        <div class="status-item paid">
          <div class="status-info">
            <span class="status-label">Đã thanh toán</span>
            <span class="status-count" id="paid-count">0</span>
          </div>
          <div class="status-bar">
            <div class="status-fill" id="paid-bar" style="width: 0%"></div>
          </div>
          <div class="status-percentage" id="paid-percentage">0%</div>
        </div>
        
        <div class="status-item refund">
          <div class="status-info">
            <span class="status-label">Hoàn tiền</span>
            <span class="status-count" id="refund-count">0</span>
          </div>
          <div class="status-bar">
            <div class="status-fill" id="refund-bar" style="width: 0%"></div>
          </div>
          <div class="status-percentage" id="refund-percentage">0%</div>
        </div>
      </div>
    </div>

    <div class="status-card">
      <h4>Tỷ lệ chuyển đổi</h4>
      <div class="conversion-metrics">
        <div class="conversion-item">
          <div class="conversion-label">Tỷ lệ thanh toán</div>
          <div class="conversion-value" id="payment-rate">0%</div>
          <div class="conversion-desc">Chậhang → Thanh toán</div>
        </div>
        <div class="conversion-item">
          <div class="conversion-label">Tỷ lệ hoàn tất</div>
          <div class="conversion-value" id="completion-rate">0%</div>
          <div class="conversion-desc">Đã TT → Hoàn tất</div>
        </div>
        <div class="conversion-item">
          <div class="conversion-label">Tỷ lệ thành công</div>
          <div class="conversion-value" id="success-rate">0%</div>
          <div class="conversion-desc">Chậhang → Hoàn tất</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Charts Row -->
  <div class="charts-row">
    <!-- Revenue by Status Chart -->
    <div class="chart-container">
      <div class="chart-header">
        <h3 class="chart-title">
          <i class="fas fa-chart-line"></i> 
          Xu hướng doanh thu theo trạng thái
        </h3>
        <div class="chart-controls">
          <button class="chart-btn" data-period="7days">7 ngày</button>
          <button class="chart-btn active" data-period="30days">30 ngày</button>
          <button class="chart-btn" data-period="90days">90 ngày</button>
          <button class="chart-btn" data-period="all">Tất cả</button>
        </div>
      </div>
      <div class="chart-content">
        <canvas id="revenue-status-chart" width="400" height="200"></canvas>
      </div>
    </div>

    <!-- Transaction Status Distribution -->
    <div class="chart-container">
      <div class="chart-header">
        <h3 class="chart-title">
          <i class="fas fa-chart-pie"></i> 
          Phân bố trạng thái giao dịch
        </h3>
        <div class="chart-actions">
          <button class="chart-btn" onclick="exportStatusData()">
            <i class="fas fa-download"></i> Xuất
          </button>
        </div>
      </div>
      <div class="chart-content status-chart-content">
        <div class="status-chart-wrapper">
          <canvas id="status-distribution-chart" width="300" height="300"></canvas>
        </div>
        <div class="status-detail-wrapper">
          <h4 class="detail-title">
            <i class="fas fa-table"></i> 
            Chi tiết theo trạng thái
          </h4>
          <div class="status-detail-table-container">
            <table class="status-detail-table">
              <thead>
                <tr>
                  <th>Trạng thái</th>
                  <th>Số lượng</th>
                  <th>Tổng tiền</th>
                  <th>Tỷ lệ</th>
                  <th>Trung bình</th>
                </tr>
              </thead>
              <tbody id="status-detail-tbody">
                <tr>
                  <td colspan="5" class="loading-row">
                    <i class="fas fa-spinner fa-spin"></i> Đang tải...
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <!-- Status Highlights -->
          <div class="status-highlights">
            <div class="highlight-card refund-highlight">
              <div class="highlight-icon">
                <i class="fas fa-exclamation-triangle"></i>
              </div>
              <div class="highlight-content">
                <div class="highlight-title">Cảnh báo Hoàn tiền</div>
                <div class="highlight-desc">Giao dịch hoàn tiền hiển thị số âm</div>
                <div class="highlight-value" id="refund-impact">-0 ₫</div>
              </div>
            </div>
            
            <div class="highlight-card success-highlight">
              <div class="highlight-icon">
                <i class="fas fa-check-circle"></i>
              </div>
              <div class="highlight-content">
                <div class="highlight-title">Tỷ lệ thành công</div>
                <div class="highlight-desc">Giao dịch hoàn tất thành công</div>
                <div class="highlight-value" id="success-rate-display">0%</div>
              </div>
            </div>
            
            <div class="highlight-card net-highlight">
              <div class="highlight-icon">
                <i class="fas fa-calculator"></i>
              </div>
              <div class="highlight-content">
                <div class="highlight-title">Doanh thu ròng</div>
                <div class="highlight-desc">Sau khi trừ hoàn tiền</div>
                <div class="highlight-value" id="net-revenue">0 ₫</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Data Tables Row -->
  <div class="tables-row">
    <!-- Top Customers -->
    <div class="data-table-container">
      <div class="table-header">
        <h3 class="table-title">
          <i class="fas fa-users"></i> 
          Khách hàng hàng đầu
        </h3>
        <div class="table-controls">
          <button class="table-btn" onclick="exportCustomerData()">
            <i class="fas fa-download"></i> Xuất
          </button>
        </div>
      </div>
      <div class="table-content">
        <table class="data-table" id="top-customers-table">
          <thead>
            <tr>
              <th>Khách hàng</th>
              <th>Giao dịch</th>
              <th>Doanh thu</th>
              <th>Xu hướng</th>
            </tr>
          </thead>
          <tbody id="top-customers-body">
            <tr>
              <td colspan="4" class="loading-row">
                <i class="fas fa-spinner fa-spin"></i> Đang tải...
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Top Software -->
    <div class="data-table-container">
      <div class="table-header">
        <h3 class="table-title">
          <i class="fas fa-laptop-code"></i> 
          Phần mềm phổ biến
        </h3>
        <div class="table-controls">
          <button class="table-btn" onclick="exportSoftwareData()">
            <i class="fas fa-download"></i> Xuất
          </button>
        </div>
      </div>
      <div class="table-content">
        <table class="data-table" id="top-software-table">
          <thead>
            <tr>
              <th>Phần mềm</th>
              <th>Số lượng</th>
              <th>Doanh thu</th>
              <th>Tỷ lệ</th>
            </tr>
          </thead>
          <tbody id="top-software-body">
            <tr>
              <td colspan="4" class="loading-row">
                <i class="fas fa-spinner fa-spin"></i> Đang tải...
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  
  <!-- Pending Transactions Section -->
  <div class="pending-transactions-section">
    <div class="section-header">
      <h3 class="section-title">
        <i class="fas fa-exclamation-circle"></i> 
        Giao dịch cần xử lý
      </h3>
      <div class="section-summary">
        <span class="summary-badge needs-delivery" id="needs-delivery-count">
          <i class="fas fa-truck"></i> Cần giao hàng: <strong>0</strong>
        </span>
        <span class="summary-badge needs-payment" id="needs-payment-count">
          <i class="fas fa-money-bill-wave"></i> Cần thu tiền: <strong>0</strong>
        </span>
      </div>
    </div>
    
    <div class="pending-tables-row">
      <!-- Needs Delivery: Paid but not completed -->
      <div class="pending-table-container needs-delivery-container">
        <div class="pending-table-header">
          <h4 class="pending-table-title">
            <i class="fas fa-truck"></i> 
            Đã thanh toán - Cần giao hàng
          </h4>
          <div class="pending-table-controls">
            <span class="priority-indicator high">
              <i class="fas fa-exclamation-triangle"></i> Ưu tiên cao
            </span>
            <button class="table-btn" onclick="exportNeedsDelivery()">
              <i class="fas fa-download"></i> Xuất
            </button>
          </div>
        </div>
        <div class="pending-table-content">
          <table class="pending-table" id="needs-delivery-table">
            <thead>
              <tr>
                <th>Ngày</th>
                <th>Khách hàng</th>
                <th>Sản phẩm</th>
                <th>Số tiền</th>
                <th>Thời gian chờ</th>
                <th>Hành động</th>
              </tr>
            </thead>
            <tbody id="needs-delivery-tbody">
              <tr>
                <td colspan="6" class="loading-row">
                  <i class="fas fa-spinner fa-spin"></i> Đang tải...
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      
      <!-- Needs Payment: Delivered but not paid -->
      <div class="pending-table-container needs-payment-container">
        <div class="pending-table-header">
          <h4 class="pending-table-title">
            <i class="fas fa-money-bill-wave"></i> 
            Đã giao hàng - Cần thu tiền
          </h4>
          <div class="pending-table-controls">
            <span class="priority-indicator medium">
              <i class="fas fa-clock"></i> Theo dõi
            </span>
            <button class="table-btn" onclick="exportNeedsPayment()">
              <i class="fas fa-download"></i> Xuất
            </button>
          </div>
        </div>
        <div class="pending-table-content">
          <table class="pending-table" id="needs-payment-table">
            <thead>
              <tr>
                <th>Ngày giao</th>
                <th>Khách hàng</th>
                <th>Sản phẩm</th>
                <th>Số tiền</th>
                <th>Quá hạn</th>
                <th>Hành động</th>
              </tr>
            </thead>
            <tbody id="needs-payment-tbody">
              <tr>
                <td colspan="6" class="loading-row">
                  <i class="fas fa-spinner fa-spin"></i> Đang tải...
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    
    <!-- Quick Actions Panel -->
    <div class="quick-actions-panel">
      <div class="action-group">
        <h5 class="action-group-title">
          <i class="fas fa-bolt"></i> Hành động nhanh
        </h5>
        <div class="action-buttons">
          <button class="action-btn delivery" onclick="markAllAsDelivered()">
            <i class="fas fa-check-circle"></i> Đánh dấu đã giao hàng
          </button>
          <button class="action-btn payment" onclick="markAllAsPaid()">
            <i class="fas fa-money-check-alt"></i> Đánh dấu đã thanh toán
          </button>
          <button class="action-btn reminder" onclick="sendPaymentReminders()">
            <i class="fas fa-bell"></i> Gửi nhắc nhở thanh toán
          </button>
        </div>
      </div>
      
      <div class="alert-group">
        <div class="alert-item overdue" id="overdue-alert" style="display: none;">
          <i class="fas fa-exclamation-triangle"></i>
          <span class="alert-text">Có <strong id="overdue-count">0</strong> giao dịch quá hạn thanh toán!</span>
          <button class="alert-btn" onclick="showOverdueDetails()">
            <i class="fas fa-eye"></i> Xem chi tiết
          </button>
        </div>
        
        <div class="alert-item urgent" id="urgent-alert" style="display: none;">
          <i class="fas fa-shipping-fast"></i>
          <span class="alert-text">Có <strong id="urgent-delivery-count">0</strong> đơn hàng cần giao gấp!</span>
          <button class="alert-btn" onclick="showUrgentDeliveries()">
            <i class="fas fa-truck-fast"></i> Xử lý ngay
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Export Controls -->
  <div class="report-actions">
    <button class="action-btn primary" onclick="exportOverviewReport()">
      <i class="fas fa-file-excel"></i> Xuất báo cáo Excel
    </button>
    <button class="action-btn secondary" onclick="printOverviewReport()">
      <i class="fas fa-print"></i> In báo cáo
    </button>
    <button class="action-btn secondary" onclick="refreshOverviewReport()">
      <i class="fas fa-sync-alt"></i> Làm mới
    </button>
  </div>